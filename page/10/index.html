<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="GwangHui Park"><meta name="copyright" content="GwangHui Park"><title>History | Gwang Story</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">GwangHui Park</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">100</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">47</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">12</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Gwang Story</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Gwang Story</div><div id="site-sub-title">History</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/20/spring-initializer/">spring-initializer</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-20</time><div class="content"><ol>
<li>An ApplicationStartingEvent is sent at the start of a run, but before any processing except the registration of listeners and initializers.</li>
<li>An ApplicationEnvironmentPreparedEvent is sent when the Environment to be used in the context is known, but before the context is created.</li>
<li>An ApplicationPreparedEvent is sent just before the refresh is started, but after bean definitions have been loaded.</li>
<li>An ApplicationReadyEvent is sent after the refresh and any related callbacks have been processed to indicate the application is ready to service requests.</li>
<li>An ApplicationFailedEvent is sent if there is an exception on startup.</li>
</ol>
<h3 id="1-sharedmetadatareaderfactorycontextinitializer"><a class="markdownIt-Anchor" href="#1-sharedmetadatareaderfactorycontextinitializer"></a> 1. SharedMetadataReaderFactoryContextInitializer</h3>
<ul>
<li>initialize 함수가 호출되면 applicationContext에 PostProcessor로 CachingMetadataReaderFactoryPostProcessor를 등록한다.</li>
</ul>
<h4 id="cachingmetadatareaderfactorypostprocessor"><a class="markdownIt-Anchor" href="#cachingmetadatareaderfactorypostprocessor"></a> CachingMetadataReaderFactoryPostProcessor</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// Must happen before the ConfigurationClassPostProcessor is created</span></span><br><span class="line">	<span class="keyword">return</span> Ordered.HIGHEST_PRECEDENCE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Ordered</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> HIGHEST_PRECEDENCE = Integer.MIN_VALUE;</span><br><span class="line">	<span class="keyword">int</span> LOWEST_PRECEDENCE = Integer.MAX_VALUE;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ConfigurationClassPostProcessor가 생성되기전 반드시 수행되어야 하는 프로세서이다.</li>
<li>HIGHEST_PRECEDENCE의 값은 Integer.MIN_VALUE</li>
<li>register 수행시 BeanDefinitionRegistry에 BeanDefinition에<br />
&quot;org.springframework.boot.autoconfigure.internalCachingMetadataReaderFactory&quot;으로 BeanDefinition 등록</li>
</ul>
<h4 id=""><a class="markdownIt-Anchor" href="#"></a> </h4>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/19/event-publishing-run-listener/">event-publishing-run-listener</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-19</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/spring-boot-listener/">spring boot listener</a></span><div class="content"><p>스프링부트가 기동 될때, 기본적으로 등록하는 Run Listener</p>
<p><img src="/images/springboot/eventpublishinglistener/eventpublisingrunlistener.png" alt="" /></p>
<p>내부에 SpringApplication을 가지고 있고,<br />
SimpleApplicationEventMulticaster에 ApplicationListener들을 등록한다.</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/19/spring-boot-application-run-listeners/">spring-boot-application-run-listeners</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-19</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/springboot/">springboot</a></span><div class="content"><p>Spring에서 사용하는 기본적인 Listeners 구현체<br />
SpringApplicationRunListener를 들고 있고 변경 불가능하게 되어있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringApplicationRunListeners</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> Log log;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> List&lt;SpringApplicationRunListener&gt; listeners;</span><br><span class="line"></span><br><span class="line">	SpringApplicationRunListeners(Log log, Collection&lt;? extends SpringApplicationRunListener&gt; listeners) &#123;</span><br><span class="line">		<span class="keyword">this</span>.log = log;</span><br><span class="line">		<span class="keyword">this</span>.listeners = <span class="keyword">new</span> ArrayList&lt;&gt;(listeners);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">starting</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) &#123;</span><br><span class="line">			listener.starting();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">environmentPrepared</span><span class="params">(ConfigurableEnvironment environment)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) &#123;</span><br><span class="line">			listener.environmentPrepared(environment);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextPrepared</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) &#123;</span><br><span class="line">			listener.contextPrepared(context);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoaded</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) &#123;</span><br><span class="line">			listener.contextLoaded(context);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">started</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) &#123;</span><br><span class="line">			listener.started(context);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">running</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) &#123;</span><br><span class="line">			listener.running(context);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">failed</span><span class="params">(ConfigurableApplicationContext context, Throwable exception)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) &#123;</span><br><span class="line">			callFailedListener(listener, context, exception);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">callFailedListener</span><span class="params">(SpringApplicationRunListener listener, ConfigurableApplicationContext context,</span></span></span><br><span class="line"><span class="function"><span class="params">			Throwable exception)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			listener.failed(context, exception);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">			<span class="keyword">if</span> (exception == <span class="keyword">null</span>) &#123;</span><br><span class="line">				ReflectionUtils.rethrowRuntimeException(ex);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">this</span>.log.isDebugEnabled()) &#123;</span><br><span class="line">				<span class="keyword">this</span>.log.error(<span class="string">"Error handling failed"</span>, ex);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				String message = ex.getMessage();</span><br><span class="line">				message = (message != <span class="keyword">null</span>) ? message : <span class="string">"no error message"</span>;</span><br><span class="line">				<span class="keyword">this</span>.log.warn(<span class="string">"Error handling failed ("</span> + message + <span class="string">")"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/19/springboot-run/">springboot-run</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-19</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/springboot/">springboot</a></span><div class="content"><p>Spring Boot를 사용한 프로젝트를 진행하다보니 Spring Boot 및 Security에 대한 전반적인 지식이 필요 해졌고,<br />
기존 설정들과는 다른 부분들이 존재해 Run을 진행하는 Entry Point 부터 하나씩 분석하기로 한다.</p>
<p><a href="https://www.jetbrains.com/help/idea/class-diagram.html" target="_blank" rel="noopener">https://www.jetbrains.com/help/idea/class-diagram.html</a> 로 클래스 다이어그램을 추출해 기록할 예정이며,<br />
분석하는 Spring Boot버전은 2.1.1, Tomcat은 9버전이 될 것이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(String... args)</span> </span>&#123;</span><br><span class="line">	StopWatch stopWatch = <span class="keyword">new</span> StopWatch();</span><br><span class="line">	stopWatch.start();</span><br><span class="line">	ConfigurableApplicationContext context = <span class="keyword">null</span>;</span><br><span class="line">	Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">	configureHeadlessProperty(); <span class="comment">// 1</span></span><br><span class="line">	SpringApplicationRunListeners listeners = getRunListeners(args); <span class="comment">// 2</span></span><br><span class="line">	listeners.starting();</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		ApplicationArguments applicationArguments = <span class="keyword">new</span> DefaultApplicationArguments(args); <span class="comment">// 1</span></span><br><span class="line">		ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);</span><br><span class="line">		configureIgnoreBeanInfo(environment);</span><br><span class="line">		Banner printedBanner = printBanner(environment);</span><br><span class="line">		context = createApplicationContext();</span><br><span class="line">		exceptionReporters = getSpringFactoriesInstances(SpringBootExceptionReporter.class,</span><br><span class="line">				<span class="keyword">new</span> Class[] &#123; ConfigurableApplicationContext.class &#125;, context);</span><br><span class="line">		prepareContext(context, environment, listeners, applicationArguments, printedBanner);</span><br><span class="line">		refreshContext(context);</span><br><span class="line">		afterRefresh(context, applicationArguments);</span><br><span class="line">		stopWatch.stop();</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.logStartupInfo) &#123;</span><br><span class="line">			<span class="keyword">new</span> StartupInfoLogger(<span class="keyword">this</span>.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);</span><br><span class="line">		&#125;</span><br><span class="line">		listeners.started(context);</span><br><span class="line">		callRunners(context, applicationArguments);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">		handleRunFailure(context, ex, exceptionReporters, listeners);</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		listeners.running(context);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">		handleRunFailure(context, ex, exceptionReporters, <span class="keyword">null</span>);</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> context;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-configure-headless-property"><a class="markdownIt-Anchor" href="#1-configure-headless-property"></a> 1 Configure HeadLess Property</h3>
<ul>
<li>SYSTEM_PROPERTY_JAVA_AWT_HEADLESS를 True로 바꿔준다.</li>
<li>SYSTEM_PROPERTY_JAVA_AWT_HEADLESS는 비 윈도우 환경에서 GUI컴포넌트를 사용할 수 있게 하는 JAVA System Property</li>
</ul>
<h3 id="2-getrunlisteners"><a class="markdownIt-Anchor" href="#2-getrunlisteners"></a> 2 getRunListeners</h3>
<ul>
<li>Observer Pattern으로 동록된 모든 Listener 들에게 해당 이벤트가 발생할 경우 전부 실행해준다.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringApplicationRunListeners</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> Log log;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> List&lt;SpringApplicationRunListener&gt; listeners;</span><br><span class="line"></span><br><span class="line">	SpringApplicationRunListeners(Log log, Collection&lt;? extends SpringApplicationRunListener&gt; listeners) &#123;</span><br><span class="line">		<span class="keyword">this</span>.log = log;</span><br><span class="line">		<span class="keyword">this</span>.listeners = <span class="keyword">new</span> ArrayList&lt;&gt;(listeners);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">starting</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) &#123;</span><br><span class="line">			listener.starting();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SpringBoot는 Listener를 별도로 등록하지 않을 경우 EventPublishingRunListener를 등록해 사용한다.</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/13/next-generation-web-styling/">next-generation-web-styling</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-13</time><div class="content"><p>Closed Caption (폐쇄 자막, 자막의 표시여부를 설정할 수 있는 자)</p>
<h2 id="1-scroll-snap"><a class="markdownIt-Anchor" href="#1-scroll-snap"></a> 1) Scroll-snap</h2>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">section</span> &#123;</span><br><span class="line">    <span class="attribute">overflow-x</span>: auto;</span><br><span class="line">    <span class="attribute">overscroll-behavior-y</span>: contain;</span><br><span class="line">    <span class="attribute">scroll-snap-type</span>: y mandatory;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">section</span> &gt; <span class="selector-tag">picture</span>&#123;</span><br><span class="line">    <span class="attribute">scroll-snap-align</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="list-with-sub-list-html"><a class="markdownIt-Anchor" href="#list-with-sub-list-html"></a> List with Sub-List HTML</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">herf</span>=<span class="string">"..."</span>&gt;</span>One<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">herf</span>=<span class="string">"..."</span> <span class="attr">aria-haspopup</span>=<span class="string">"true"</span>&gt;</span>TWO<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">""</span><span class="attr">dropdown</span>" <span class="attr">aria-label</span>=<span class="string">"submenu"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">herf</span>=<span class="string">"..."</span>&gt;</span>SUB-1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">li</span><span class="selector-pseudo">:hover</span> &gt; <span class="selector-tag">el</span>,</span><br><span class="line"><span class="selector-tag">li</span><span class="selector-pseudo">:focus</span> &gt; <span class="selector-tag">ul</span> &#123;</span><br><span class="line"><span class="attribute">visibility</span>: visible;</span><br><span class="line"><span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-media-prefers-"><a class="markdownIt-Anchor" href="#2-media-prefers-"></a> 2) @media (prefers-*)</h2>
<h3 id="prefers-reduced-motion"><a class="markdownIt-Anchor" href="#prefers-reduced-motion"></a> prefers-reduced-motion</h3>
<p><img src="/images/next-generation-web-styling/prefer_1.png" alt="" /><br />
<img src="/images/next-generation-web-styling/prefer_2.png" alt="" /></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">media</span> (prefers-reduced-motion: reduce) &#123;</span><br><span class="line">    <span class="selector-tag">animation</span>: <span class="selector-tag">cross-fade</span> 3<span class="selector-tag">s</span> <span class="selector-tag">ease-in-out</span> <span class="selector-tag">infinite</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="prefers-color-scheme"><a class="markdownIt-Anchor" href="#prefers-color-scheme"></a> prefers-color-scheme</h3>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@media(prefers-color-scheme: dark) &#123;</span><br><span class="line">    <span class="selector-tag">--lightness</span>: 90%;</span><br><span class="line">    <span class="selector-tag">--text-1</span>: <span class="selector-tag">hsl</span>(200 10% <span class="selector-tag">var</span>(<span class="selector-tag">--lightness</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-logical-properties"><a class="markdownIt-Anchor" href="#3-logical-properties"></a> 3) Logical properties</h2>
<h3 id="new-mental-modal"><a class="markdownIt-Anchor" href="#new-mental-modal"></a> new mental modal</h3>
<p>the browser does all of that great work for you to make that website more internaltionalized.<br />
<img src="/images/next-generation-web-styling/localproperty_1.png" alt="" /><br />
<img src="/images/next-generation-web-styling/localproperty_2.png" alt="" /><br />
<img src="/images/next-generation-web-styling/localproperty_3.png" alt="" /><br />
<img src="/images/next-generation-web-styling/localproperty_4.png" alt="" /></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;  </span><br><span class="line">    <span class="attribute">block-size</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">inline-size</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.h2</span>, <span class="selector-tag">p</span> &#123;</span><br><span class="line">    // margin-left: 3rem;</span><br><span class="line">    <span class="selector-tag">margin-inline-start</span>: 3<span class="selector-tag">rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">main</span> &#123;</span><br><span class="line">    //border-top: 2px dashed;</span><br><span class="line">    <span class="selector-tag">border-block-start</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">dashed</span>;</span><br><span class="line">    //margin-top: 3rem;</span><br><span class="line">    <span class="selector-tag">margin-block-start</span>: 3<span class="selector-tag">rem</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://wit.nts-corp.com/2018/08/28/5317" target="_blank" rel="noopener">https://wit.nts-corp.com/2018/08/28/5317</a></p>
<h2 id="4-sticky-situations"><a class="markdownIt-Anchor" href="#4-sticky-situations"></a> 4) Sticky situations</h2>
<p>Classic sticky<br />
The Sticky stack {CSS}<br />
Ui layers overlap within the viewport</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">dl</span> &gt; <span class="selector-tag">dt</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: sticky;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dt</span>&gt;</span>A<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">dt</span>&gt;</span>B<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>The sticky Desperado {HTML}</p>
<h2 id="5-backdrop-filter"><a class="markdownIt-Anchor" href="#5-backdrop-filter"></a> 5) backdrop-filter</h2>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">element</span><span class="selector-class">.style</span> &#123;</span><br><span class="line">    <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(10px);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-is"><a class="markdownIt-Anchor" href="#6-is"></a> 6) :is()</h2>
<h3 id="any-match"><a class="markdownIt-Anchor" href="#any-match"></a> any(), match()</h3>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">button</span><span class="selector-pseudo">:is(.focus</span>, <span class="selector-pseudo">:focus)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">article</span> &gt; <span class="selector-pseudo">:is(h1</span>,<span class="selector-tag">h2</span>,<span class="selector-tag">h3</span>,<span class="selector-tag">h4</span>,<span class="selector-tag">h5</span>,<span class="selector-tag">h6</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7-grid-gap-gap-for-flexbox"><a class="markdownIt-Anchor" href="#7-grid-gap-gap-for-flexbox"></a> 7) grid gap gap (for Flexbox)</h2>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-button</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-flex;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">place-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="8-houdini"><a class="markdownIt-Anchor" href="#8-houdini"></a> 8) Houdini</h2>
<h3 id="low-level-css"><a class="markdownIt-Anchor" href="#low-level-css"></a> low-level css</h3>
<p><img src="/images/next-generation-web-styling/houdini_1.png" alt="" /><br />
<img src="/images/next-generation-web-styling/houdini_2.png" alt="" /></p>
<h2 id="9-properties-values-api"><a class="markdownIt-Anchor" href="#9-properties-values-api"></a> 9) Properties &amp; Values API</h2>
<p><img src="/images/next-generation-web-styling/property_value_1.png" alt="" /><br />
<img src="/images/next-generation-web-styling/property_value_2.png" alt="" /><br />
<img src="/images/next-generation-web-styling/property_value_3.png" alt="" /></p>
<h2 id="10-typed-om"><a class="markdownIt-Anchor" href="#10-typed-om"></a> 10) Typed OM</h2>
<p><img src="/images/next-generation-web-styling/typedOM_1.png" alt="" /></p>
<h2 id="11-paint-api"><a class="markdownIt-Anchor" href="#11-paint-api"></a> 11) Paint API</h2>
<p><img src="/images/next-generation-web-styling/paintedAPI_1.png" alt="" /><br />
<img src="/images/next-generation-web-styling/paintedAPI_2.png" alt="" /><br />
<img src="/images/next-generation-web-styling/paintedAPI_3.png" alt="" /><br />
<img src="/images/next-generation-web-styling/paintedAPI_4.png" alt="" /></p>
<h2 id="12-animation-worklet"><a class="markdownIt-Anchor" href="#12-animation-worklet"></a> 12) Animation Worklet</h2>
<p><img src="/images/next-generation-web-styling/animation_worklet_1.png" alt="" /></p>
<h2 id="speed-round"><a class="markdownIt-Anchor" href="#speed-round"></a> Speed Round</h2>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123; <span class="attribute">size</span>: <span class="number">50vw</span>; &#125;</span><br><span class="line"><span class="selector-tag">iframe</span> &#123; <span class="attribute">aspect-ratio</span>: <span class="number">16</span> / <span class="number">9</span>;&#125;</span><br><span class="line">// min(),max(),clamp() </span><br><span class="line"><span class="selector-tag">h1</span> &#123; <span class="attribute">font-size</span>: <span class="built_in">clamp</span>(1.5rem, 6vw);&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://css-at-cds.netlify.com/" target="_blank" rel="noopener">https://css-at-cds.netlify.com/</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/11/adaptive-loading/">adaptive-loading</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Web/">Web</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Web/JavaScript/">JavaScript</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/javascript/">javascript</a></span><div class="content"><p><a href="https://youtu.be/puUPpVrIRkc" target="_blank" rel="noopener">https://youtu.be/puUPpVrIRkc</a></p>
<ul>
<li>Adaptive Loading for improving performance (slick experience)<br />
Do we need to deliver the exact same experience to every user?<br />
많은 웹사이트들에서 자바스크립트가 많이 사용되고 있고 자바스크립트는 single thread 기반으로 실행된다.<br />
다양한 디바이스들의 성능은 Benchmark 를 보더라도 매년 향상되고 있지만 싱글 CPU 자체의 성능은 많이 향상되지 않았다.</li>
</ul>
<p>for example<br />
youtube -&gt; 514kb js download</p>
<p>network type change to fast 3g<br />
youtube used low network module?</p>
<p>Network-aware Resource Loading<br />
react-adaptive-hooks<br />
adaptive-vue</p>
<p>19년 12월 기준 chrome Experimental</p>
<p>const network = navigator.connection.effectiveType;</p>
<figure class="highlight jsx"><figcaption><span>harmony</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; useNetworkStatus &#125; <span class="keyword">from</span> <span class="string">'react-adaptive-hooks/network'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MyComponent = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; effectiveConnectionType &#125; = useNetworkStatus();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> media;</span><br><span class="line">  <span class="keyword">switch</span>(effectiveConnectionType) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'2g'</span>:</span><br><span class="line">      media = <span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'medium-res.jpg'</span>/&gt;</span>;</span></span><br><span class="line"><span class="xml">      break;</span></span><br><span class="line"><span class="xml">    case '3g':</span></span><br><span class="line">      media = &lt;img src='high-res.jpg'/&gt;;</span><br><span class="line">      break;</span><br><span class="line">    case '4g':</span><br><span class="line">      media = &lt;video muted controls&gt;...&lt;/video&gt;;</span><br><span class="line">      break;</span><br><span class="line">    default:</span><br><span class="line">      media = &lt;video muted controls&gt;...&lt;/video&gt;;</span><br><span class="line">      break;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return &lt;div&gt;&#123;media&#125;&lt;/div&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>####memory<br />
navigator.deviceMemory</p>
<p>####cpu<br />
navigator.hardwareConcurrency</p>
<p>####Adaptive Capability Toggling</p>
<p>####Adaptive Delivery with Client Hints<br />
Enable</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Accept-CH"</span> <span class="attr">content</span>=<span class="string">"Device-Memory, Viewport-Width Save-Data"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>Added<br />
Accept-CH : Device-Memory, Save-Data, Viewport-Width</p>
<p>slick experience &lt;-&gt; choppy experience</p>
<p>Do not just respond based on screen size, adapt based on actual device hardware.</p>
<ol>
<li>Define buckets</li>
<li>Integrate buckets into logging</li>
<li>Adapt loading based on buckets<br />
<img src="/images/adaptiveLoading/adaptiveLoading_1.png" alt="" /><br />
<img src="/images/adaptiveLoading/adaptiveLoading_2.png" alt="" /><br />
<img src="/images/adaptiveLoading/adaptiveLoading_3.png" alt="" /><br />
<img src="/images/adaptiveLoading/adaptiveLoading_4.png" alt="" /><br />
<img src="/images/adaptiveLoading/adaptiveLoading_5.png" alt="" /><br />
<img src="/images/adaptiveLoading/adaptiveLoading_6.png" alt="" /><br />
<img src="/images/adaptiveLoading/adaptiveLoading_7.png" alt="" /></li>
</ol>
<p>browser 기준으로</p>
<ol>
<li>Log hardwareConcurrency and deviceMemory</li>
<li>Group by hardwareConcurrency, DeviceMemory, and OS when looking at perf data</li>
<li>figure out buckets based on groupings.</li>
</ol>
<p>adaptivity should be considered in your core frameworks</p>
<p>Think about animations</p>
<p>Low End &lt;- animation 제거<br />
High End</p>
<p>Mobile Websites (Viewport-Width, CPU 등)</p>
<p>Load fast vs respond fast</p>
<p>Trade-off</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isLowEndDevice()) &#123;</span><br><span class="line">    scheduler.unstable_forceFrameRate(<span class="number">15</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/11/22/spring-security/">spring-security</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-11-22</time><div class="content"><h2 id="authentication-manager"><a class="markdownIt-Anchor" href="#authentication-manager"></a> Authentication Manager</h2>
<p>Spring Security에서는 AuthenticationManager라는 Interface가 존재하고 이를 구현하면 된다.<br />
웹 어플리케이션에서 보통 WebConfig를 설정하기 위해 extends 받는 객체가 WebSecurityConfigurerAdapter이며<br />
이는 WebSecurityConfigurer를 구현한 것이다.<br />
Init함수 실행시 HttpSecurity를 생성하고 내부적으로 내부 init 함수 안에서 최초 1번 생성해서 반환하게 된다.</p>
<h2 id="provider-manager"><a class="markdownIt-Anchor" href="#provider-manager"></a> Provider Manager</h2>
<p>Provider Manager는 Request의 Authentication을 다루는 AuthenticationProvider를 관리하기 위한 manager이며,<br />
각각의 AuthenticationProvider의 구현에 따라 인증할 수 있는 범위가 넓어지며,<br />
DAO기반, LDAP기반, anonymous기반 등 여러가지 Provider를 관리할 수 있다. 만약 각 Provider에서 처리할 수 없고 null값이 나온다면<br />
Provider Manager는 ProviderNotFoundException을 Throw 해 처리한다.</p>
<h2 id="authentication-daoauthenticationprovider"><a class="markdownIt-Anchor" href="#authentication-daoauthenticationprovider"></a> Authentication - DaoAuthenticationProvider</h2>
<p>Authentication의 간단한 구현체는 DaoAuthenticationProvider이며 이는 프레임워크에서 조기에 지원한 하나의 구현체입니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaoAuthenticationProvider</span> <span class="keyword">extends</span> <span class="title">AbstractUserDetailsAuthenticationProvider</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String USER_NOT_FOUND_PASSWORD = <span class="string">"userNotFoundPassword"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> PasswordEncoder passwordEncoder;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">volatile</span> String userNotFoundEncodedPassword;</span><br><span class="line">    ## UserDetailService</span><br><span class="line">	<span class="keyword">private</span> UserDetailsService userDetailsService;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> UserDetailsPasswordService userDetailsPasswordService;</span><br></pre></td></tr></table></figure>
<p>UserDetailService를 Injection받아 해당 유저가 올바른 유저인지 체크한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetailsService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.provisioning.InMemoryUserDetailsManager;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserDetailsService <span class="title">userDetailsService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        InMemoryUserDetailsManager manager = <span class="keyword">new</span> InMemoryUserDetailsManager();</span><br><span class="line">        manager.createUser(User.withUsername(<span class="string">"user"</span>).password(<span class="string">"password"</span>).roles(<span class="string">"USER"</span>).build());</span><br><span class="line">        <span class="keyword">return</span> manager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        http.</span><br><span class="line">            authorizeRequests()</span><br><span class="line">            .antMatchers(<span class="string">"/db-console/**"</span>)</span><br><span class="line">            .permitAll().anyRequest().authenticated();</span><br><span class="line">        http.csrf().disable();</span><br><span class="line">        http.headers().frameOptions().disable();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>보통 테스트시에는 InMemoryUserDetailsManager를 UserDetailsService 빈으로 생성해 사용한다.<br />
인증을 성공한 이후 보안상의 문제로 인증된 Authentication 객체를 삭제한다고 한다. 허나 Stateless Application상의 성능 향상을 위해선 Cache가 필수이고<br />
이를 지원하기 위해 AuthenticationProvider에 캐쉬구현을 하거나 복사본을 만들어 놓고, eraseCredentialsAfterAuthentication Property를 disable 할수도 있다고 한다.<br />
자세한 사항은 Javadoc의 구현을 확인하라고 한다.</p>
<h3 id="userdetailservice"><a class="markdownIt-Anchor" href="#userdetailservice"></a> UserDetailService</h3>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/11/21/spring-security-filter/">spring_security_filter</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-11-21</time><div class="content"><table>
<thead>
<tr>
<th>순서</th>
<th>제목</th>
<th>내용</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>WebAsyncManagerIntegrationFilter</td>
<td>조사 요망</td>
</tr>
<tr>
<td>2</td>
<td>SecurityContextPersistence Filter</td>
<td>Security Context Repository에서 SecurityContext를 로드하고 저장</td>
</tr>
<tr>
<td>3</td>
<td>HeaderWriterFilter</td>
<td>조사 요망</td>
</tr>
<tr>
<td>4</td>
<td>Logout Filter</td>
<td>로그아웃 URL로 지정된 가상 URL에 대한 요청 감시, 매칭되면 로그아웃</td>
</tr>
<tr>
<td>5</td>
<td>UsernamePasswordAuthenticationFilter</td>
<td>사용자명과 비밀번호로 이뤄진 폼 기반 인증 URL 확인 및 인증 진행</td>
</tr>
<tr>
<td>6</td>
<td>RequestCacheAwareFilter</td>
<td>로그인 성공 이후 인증 요청에 의해 가로 채어진 사용자의 원래 요청을 재구성</td>
</tr>
<tr>
<td>7</td>
<td>SecurityContextHolderAwareRequestFilter</td>
<td>조사 요망</td>
</tr>
<tr>
<td>8</td>
<td>AnonymousAuthenticationFilter</td>
<td>이 필터가 호출되는 시점까지 사용자가 아직 인증을 받지 못했다면 요청 관련 인증 토큰에서 사용자가 익명 사용자로 나타남</td>
</tr>
<tr>
<td>9</td>
<td>SessionManagementFilter</td>
<td>인증된 주체를 바탕으로 세션 트래킹을 처리해 단일 주체와 관련된 모든 세션 트래킹</td>
</tr>
<tr>
<td>10</td>
<td>ExceptionTranslationFilter</td>
<td>발생하는 예외 처리 담당</td>
</tr>
<tr>
<td>11</td>
<td>FilterSecurityFilter</td>
<td>권한부여 등 여러 결정을 AccessDecisionManager에게 위임해 최종 제어</td>
</tr>
</tbody>
</table>
<p>하단은 타 블로그에서 참조</p>
<p>SecurityContextPersistenceFilter</p>
<p>SecurityContextRepository 에서 SecurityContext 를 로딩하거나 SecurityContextRepository 로 SecurityContext 를 저장하는 역할을 한다.SecurityContext 란 사용자의 보호및 인증된 세션을 의미한다.</p>
<p>LogoutFilter</p>
<p>로그아웃 URL(디폴트 값 : /j_spring_security_logout) 로의 요청을 감시하여 해당 사용자를 로그아웃 시킨다.</p>
<p>UsernamePasswordAuthenticationFilter</p>
<p>username 과 password 를 사용하는 폼기반 인증 요청 URL(디폴트 값: /j_spring_security_check) 을 감시하여 사용자를 인증하는 역할을 한다.</p>
<p>DefaultLoginPageGeneratingFilter</p>
<p>폼또는 OpenID 기반 인증을 위한 로그인폼 URL(디폴트 값: /spring_security_login)을 감시하여 로그인폼을 생성한다.</p>
<p>BasicAuthenticationFilter</p>
<p>HTTP 기본 인증 헤더를 감시하여 처리한다.</p>
<p>RequestCacheAwareFilter</p>
<p>로그인 성공 후, 원래 요청 정보를 재구성하기 위해 사용됨</p>
<p>SecurityContextHolderAwareRequestFilter</p>
<p>HttpServletRequestWrapper 를 상속한 SecurityContextHolderAwareRequestWapper 클래스로 HttpServletRequest 정보를 감싼다. SecurityContextHolderAwareRequestWrapper 클래스는 필터 체인상의 다음 필터들에게 추가 정보를 제공한다.</p>
<p>AnonymousAuthenticationFilter</p>
<p>이 필터가 호출되는 시점까지 사용자 정보가 인증되지 않았다면 사용자가 익명이라는 것 나타내는 인증토큰이 요청과 관련지어 진다.</p>
<p>SessionManagementFilter</p>
<p>이 필터는 하나의 인증된 사용자와 관련된 모든 세션을 추적하고, 인증된 사용자 정보를 기반으로 세션을 추적을 처리한다.</p>
<p>ExceptionTranslationFilter</p>
<p>이 필터는 보호된 요청을 처리하는 중에 발생하는 예상된 예외를 위임하거나 전달하는 역할을 한다.</p>
<p>FilterSecurityInterceptor</p>
<p>이 필터는 AccessDecisionManager 로 인증에 대한 결정권을 위임함으로써 인증허가 및  접근제어 결정을 용이하게 한다.</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/10/28/Setting/">Setting</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-10-28</time><div class="content"><p><a href="https://github.com/LouisBarranqueiro" target="_blank" rel="noopener">https://github.com/LouisBarranqueiro</a><br />
<a href="https://github.com/LouisBarranqueiro/hexo-algoliasearch" target="_blank" rel="noopener">https://github.com/LouisBarranqueiro/hexo-algoliasearch</a><br />
hello<br />
olleh</p>
<p><img src="/images/jvm_stack_01.gif" alt="" /></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/10/28/intro/">intro</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-10-28</time><div class="content"></div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By GwangHui Park</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>